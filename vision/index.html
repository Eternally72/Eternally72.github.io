<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>豆瓣电影评分排行榜 - Hadoop小型集群版</title>
    <style>
        body {
            font-family: 'Helvetica Neue', Arial, sans-serif;
            line-height: 1.6;
            color: #333;
            max-width: 1000px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .header {
            background: linear-gradient(135deg, #007722, #006666);
            color: white;
            padding: 20px;
            border-radius: 5px;
            margin-bottom: 20px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        h1 {
            margin: 0;
            font-size: 24px;
        }
        .subtitle {
            font-size: 14px;
            opacity: 0.9;
            margin-top: 8px;
        }
        .hadoop-badge {
            display: inline-block;
            background-color: #FF9900;
            color: white;
            padding: 2px 8px;
            border-radius: 12px;
            font-size: 11px;
            font-weight: bold;
            margin-left: 8px;
            vertical-align: middle;
        }
        .cluster-info {
            background-color: #f0f0f0;
            padding: 12px;
            border-radius: 5px;
            margin: 15px 0;
            font-size: 13px;
        }
        .cluster-nodes {
            display: flex;
            justify-content: space-around;
            margin: 10px 0;
        }
        .node {
            text-align: center;
            padding: 8px;
            background-color: white;
            border-radius: 5px;
            width: 30%;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }
        .node.active {
            background-color: #e6f7e6;
            border: 1px solid #007722;
        }
        .movie-table {
            width: 100%;
            border-collapse: collapse;
            background-color: white;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
            border-radius: 5px;
            overflow: hidden;
            font-size: 14px;
        }
        .movie-table th {
            background-color: #007722;
            color: white;
            padding: 12px;
            text-align: left;
        }
        .movie-table td {
            padding: 12px;
            border-bottom: 1px solid #eee;
        }
        .movie-table tr:last-child td {
            border-bottom: none;
        }
        .movie-table tr:hover {
            background-color: #f9f9f9;
        }
        .rating {
            font-weight: bold;
            color: #007722;
        }
        .rank {
            font-weight: bold;
            color: #333;
            width: 40px;
        }
        .node-indicator {
            display: inline-block;
            width: 10px;
            height: 10px;
            border-radius: 50%;
            margin-right: 5px;
        }
        .node-1 { background-color: #FF9900; }
        .node-2 { background-color: #007722; }
        .node-3 { background-color: #3366CC; }
        .footer {
            margin-top: 20px;
            text-align: center;
            font-size: 12px;
            color: #999;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>豆瓣电影评分分析 <span class="hadoop-badge">Hadoop 3节点集群</span></h1>
        <div class="subtitle">基于小型Hadoop集群处理的电影评分数据分析</div>
    </div>

    <div class="cluster-info">
        <strong>集群状态：</strong> 运行中 | <strong>节点数：</strong> 3 (1 NameNode + 2 DataNodes) | <strong>数据量：</strong> 约50万条记录
        <div class="cluster-nodes">
            <div class="node active">
                <strong>NameNode</strong><br>
                master-node
            </div>
            <div class="node active">
                <strong>DataNode</strong><br>
                worker-node1
            </div>
            <div class="node active">
                <strong>DataNode</strong><br>
                worker-node2
            </div>
        </div>
    </div>

    <table class="movie-table">
        <thead>
            <tr>
                <th width="40">排名</th>
                <th>电影名称</th>
                <th width="80">评分</th>
                <th width="100">年份</th>
                <th width="120">处理节点</th>
            </tr>
        </thead>
        <tbody id="movie-list">
            <!-- 电影数据将通过JavaScript动态加载 -->
        </tbody>
    </table>

    <div class="footer">
        © 2025 Hadoop小型集群分析平台 | 数据更新时间: <span id="update-time"></span>
    </div>

    <script>
        // 模拟从Hadoop集群处理后的电影数据 (100条)
        const movieData = [
            { name: "肖申克的救赎", rating: 9.7, year: 1994, node: 1 },
            { name: "霸王别姬", rating: 9.6, year: 1993, node: 2 },
            { name: "阿甘正传", rating: 9.5, year: 1994, node: 3 },
            { name: "这个杀手不太冷", rating: 9.4, year: 1994, node: 1 },
            { name: "泰坦尼克号", rating: 9.4, year: 1997, node: 2 },
            { name: "美丽人生", rating: 9.5, year: 1997, node: 3 },
            { name: "千与千寻", rating: 9.4, year: 2001, node: 1 },
            { name: "辛德勒的名单", rating: 9.5, year: 1993, node: 2 },
            { name: "盗梦空间", rating: 9.3, year: 2010, node: 3 },
            { name: "忠犬八公的故事", rating: 9.4, year: 2009, node: 1 },
            { name: "海上钢琴师", rating: 9.3, year: 1998, node: 2 },
            { name: "楚门的世界", rating: 9.3, year: 1998, node: 3 },
            { name: "三傻大闹宝莱坞", rating: 9.2, year: 2009, node: 1 },
            { name: "机器人总动员", rating: 9.3, year: 2008, node: 2 },
            { name: "放牛班的春天", rating: 9.3, year: 2004, node: 3 },
            { name: "大话西游之大圣娶亲", rating: 9.2, year: 1995, node: 1 },
            { name: "疯狂动物城", rating: 9.2, year: 2016, node: 2 },
            { name: "无间道", rating: 9.2, year: 2002, node: 3 },
            { name: "熔炉", rating: 9.3, year: 2011, node: 1 },
            { name: "教父", rating: 9.3, year: 1972, node: 2 },
            { name: "当幸福来敲门", rating: 9.1, year: 2006, node: 3 },
            { name: "龙猫", rating: 9.2, year: 1988, node: 1 },
            { name: "怦然心动", rating: 9.1, year: 2010, node: 2 },
            { name: "控方证人", rating: 9.6, year: 1957, node: 3 },
            { name: "蝙蝠侠：黑暗骑士", rating: 9.2, year: 2008, node: 1 },
            { name: "活着", rating: 9.3, year: 1994, node: 2 },
            { name: "乱世佳人", rating: 9.3, year: 1939, node: 3 },
            { name: "寻梦环游记", rating: 9.1, year: 2017, node: 1 },
            { name: "摔跤吧！爸爸", rating: 9.0, year: 2016, node: 2 },
            { name: "指环王3：王者无敌", rating: 9.2, year: 2003, node: 3 },
            { name: "天空之城", rating: 9.1, year: 1986, node: 1 },
            { name: "鬼子来了", rating: 9.3, year: 2000, node: 2 },
            { name: "素媛", rating: 9.3, year: 2013, node: 3 },
            { name: "十二怒汉", rating: 9.4, year: 1957, node: 1 },
            { name: "哈尔的移动城堡", rating: 9.1, year: 2004, node: 2 },
            { name: "少年派的奇幻漂流", rating: 9.1, year: 2012, node: 3 },
            { name: "天堂电影院", rating: 9.2, year: 1988, node: 1 },
            { name: "大闹天宫", rating: 9.4, year: 1961, node: 2 },
            { name: "搏击俱乐部", rating: 9.0, year: 1999, node: 3 },
            { name: "罗马假日", rating: 9.1, year: 1953, node: 1 },
            { name: "闻香识女人", rating: 9.1, year: 1992, node: 2 },
            { name: "辩护人", rating: 9.2, year: 2013, node: 3 },
            { name: "死亡诗社", rating: 9.1, year: 1989, node: 1 },
            { name: "窃听风暴", rating: 9.2, year: 2006, node: 2 },
            { name: "两杆大烟枪", rating: 9.1, year: 1998, node: 3 },
            { name: "飞越疯人院", rating: 9.1, year: 1975, node: 1 },
            { name: "教父2", rating: 9.3, year: 1974, node: 2 },
            { name: "指环王2：双塔奇兵", rating: 9.1, year: 2002, node: 3 },
            { name: "指环王1：魔戒再现", rating: 9.0, year: 2001, node: 1 },
            { name: "V字仇杀队", rating: 9.0, year: 2005, node: 2 },
            { name: "钢琴家", rating: 9.2, year: 2002, node: 3 },
            { name: "美国往事", rating: 9.2, year: 1984, node: 1 },
            { name: "黑客帝国", rating: 9.0, year: 1999, node: 2 },
            { name: "狮子王", rating: 9.1, year: 1994, node: 3 },
            { name: "沉默的羔羊", rating: 9.0, year: 1991, node: 1 },
            { name: "小鞋子", rating: 9.2, year: 1997, node: 2 },
            { name: "拯救大兵瑞恩", rating: 9.0, year: 1998, node: 3 },
            { name: "致命魔术", rating: 9.0, year: 2006, node: 1 },
            { name: "七宗罪", rating: 9.0, year: 1995, node: 2 },
            { name: "被嫌弃的松子的一生", rating: 9.1, year: 2006, node: 3 },
            { name: "萤火虫之墓", rating: 9.1, year: 1988, node: 1 },
            { name: "天使爱美丽", rating: 9.0, year: 2001, node: 2 },
            { name: "红辣椒", rating: 9.0, year: 2006, node: 3 },
            { name: "幽灵公主", rating: 9.1, year: 1997, node: 1 },
            { name: "阳光灿烂的日子", rating: 9.1, year: 1994, node: 2 },
            { name: "未麻的部屋", rating: 9.0, year: 1997, node: 3 },
            { name: "情书", rating: 9.0, year: 1995, node: 1 },
            { name: "第六感", rating: 9.0, year: 1999, node: 2 },
            { name: "东京物语", rating: 9.2, year: 1953, node: 3 },
            { name: "爱在黎明破晓前", rating: 9.0, year: 1995, node: 1 },
            { name: "蝴蝶效应", rating: 9.0, year: 2004, node: 2 },
            { name: "断背山", rating: 9.0, year: 2005, node: 3 },
            { name: "告白", rating: 9.0, year: 2010, node: 1 },
            { name: "玛丽和马克思", rating: 9.0, year: 2009, node: 2 },
            { name: "西西里的美丽传说", rating: 9.0, year: 2000, node: 3 },
            { name: "一一", rating: 9.1, year: 2000, node: 1 },
            { name: "入殓师", rating: 9.0, year: 2008, node: 2 },
            { name: "狩猎", rating: 9.1, year: 2012, node: 3 },
            { name: "超脱", rating: 9.0, year: 2011, node: 1 },
            { name: "小森林 夏秋篇", rating: 9.0, year: 2014, node: 2 },
            { name: "请以你的名字呼唤我", rating: 9.0, year: 2017, node: 3 },
            { name: "布达佩斯大饭店", rating: 9.0, year: 2014, node: 1 },
            { name: "你的名字。", rating: 9.0, year: 2016, node: 2 },
            { name: "海边的曼彻斯特", rating: 9.0, year: 2016, node: 3 },
            { name: "绿皮书", rating: 9.0, year: 2018, node: 1 },
            { name: "寄生虫", rating: 9.0, year: 2019, node: 2 },
            { name: "小丑", rating: 9.0, year: 2019, node: 3 },
            { name: "心灵奇旅", rating: 9.0, year: 2020, node: 1 },
            { name: "困在时间里的父亲", rating: 9.0, year: 2020, node: 2 },
            { name: "驾驶我的车", rating: 9.0, year: 2021, node: 3 },
            { name: "西线无战事", rating: 9.0, year: 2022, node: 1 },
            { name: "奥本海默", rating: 9.0, year: 2023, node: 2 },
            { name: "坠落的审判", rating: 9.0, year: 2023, node: 3 }
        ];

        // 按评分从高到低排序
        movieData.sort((a, b) => b.rating - a.rating);

        // 渲染电影列表
        const movieList = document.getElementById('movie-list');
        movieData.forEach((movie, index) => {
            const row = document.createElement('tr');
            row.innerHTML = `
                <td class="rank">${index + 1}</td>
                <td>${movie.name}</td>
                <td class="rating">${movie.rating}</td>
                <td>${movie.year}</td>
                <td><span class="node-indicator node-${movie.node}"></span> worker-node${movie.node}</td>
            `;
            movieList.appendChild(row);
        });

        // 设置更新时间
        const now = new Date();
        document.getElementById('update-time').textContent = now.toLocaleString('zh-CN', {
            year: 'numeric',
            month: 'long',
            day: 'numeric',
            hour: '2-digit',
            minute: '2-digit'
        });

        // 模拟从Hadoop集群获取数据
        console.log("正在从3节点Hadoop集群获取数据...");
        console.log("连接HDFS... master-node:9000");
        console.log("读取/output/douban_top100/part-r-00000...");
        console.log("数据加载完成，共100条记录");
    </script>
</body>
</html>
