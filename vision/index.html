<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>è±†ç“£ç”µå½±è¯„åˆ†æ’è¡Œæ¦œ - Hadoopå¤§æ•°æ®åˆ†æå¹³å°</title>
    <style>
        body {
            font-family: 'Helvetica Neue', Arial, sans-serif;
            line-height: 1.6;
            color: #333;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .header {
            background: linear-gradient(135deg, #007722, #006666);
            color: white;
            padding: 25px;
            border-radius: 5px;
            margin-bottom: 30px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
            position: relative;
            overflow: hidden;
        }
        .header::after {
            content: "";
            position: absolute;
            top: 0;
            right: 0;
            width: 150px;
            height: 100%;
            background: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><path fill="%23ffffff20" d="M30,10L50,30L70,10L90,30L70,50L90,70L70,90L50,70L30,90L10,70L30,50L10,30L30,10Z"/></svg>') no-repeat;
            background-size: contain;
            opacity: 0.2;
        }
        h1 {
            margin: 0;
            font-size: 32px;
        }
        .subtitle {
            font-size: 16px;
            opacity: 0.9;
            margin-top: 10px;
        }
        .hadoop-badge {
            display: inline-block;
            background-color: #FF9900;
            color: white;
            padding: 3px 10px;
            border-radius: 15px;
            font-size: 12px;
            font-weight: bold;
            margin-left: 10px;
            vertical-align: middle;
        }
        .data-process {
            background-color: #f8f8f8;
            border-left: 4px solid #007722;
            padding: 15px;
            margin-bottom: 25px;
            border-radius: 0 5px 5px 0;
        }
        .process-steps {
            display: flex;
            justify-content: space-between;
            margin: 20px 0;
            flex-wrap: wrap;
        }
        .process-step {
            flex: 1;
            min-width: 150px;
            text-align: center;
            padding: 15px;
            margin: 5px;
            background-color: white;
            border-radius: 5px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
            position: relative;
        }
        .process-step::after {
            content: "â†’";
            position: absolute;
            right: -15px;
            top: 50%;
            transform: translateY(-50%);
            color: #999;
        }
        .process-step:last-child::after {
            display: none;
        }
        .step-icon {
            font-size: 24px;
            margin-bottom: 10px;
            color: #007722;
        }
        .step-title {
            font-weight: bold;
            margin-bottom: 5px;
        }
        .step-desc {
            font-size: 12px;
            color: #666;
        }
        .movie-table {
            width: 100%;
            border-collapse: collapse;
            background-color: white;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
            border-radius: 5px;
            overflow: hidden;
        }
        .movie-table th {
            background-color: #007722;
            color: white;
            padding: 15px;
            text-align: left;
        }
        .movie-table td {
            padding: 15px;
            border-bottom: 1px solid #eee;
        }
        .movie-table tr:last-child td {
            border-bottom: none;
        }
        .movie-table tr:hover {
            background-color: #f9f9f9;
        }
        .rating {
            font-weight: bold;
            color: #007722;
        }
        .rank {
            font-weight: bold;
            color: #333;
            width: 50px;
        }
        .footer {
            margin-top: 40px;
            text-align: center;
            font-size: 13px;
            color: #999;
            padding-top: 20px;
            border-top: 1px solid #eee;
        }
        .data-source {
            margin-top: 30px;
            font-size: 14px;
            color: #666;
            background-color: #f8f8f8;
            padding: 15px;
            border-radius: 5px;
        }
        .hadoop-cluster {
            background-color: #333;
            color: white;
            padding: 15px;
            border-radius: 5px;
            margin: 20px 0;
            font-family: monospace;
            font-size: 14px;
            line-height: 1.5;
            overflow-x: auto;
        }
        .cluster-line {
            margin-bottom: 5px;
        }
        .cluster-line::before {
            content: "$ ";
            color: #FF9900;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>è±†ç“£ç”µå½±è¯„åˆ†å¤§æ•°æ®åˆ†æå¹³å° <span class="hadoop-badge">Hadoop</span></h1>
        <div class="subtitle">åŸºäºHadoopç”Ÿæ€ç³»ç»Ÿå¤„ç†çš„æµ·é‡ç”µå½±è¯„åˆ†æ•°æ®åˆ†æ</div>
    </div>

    <div class="data-process">
        <h3>å¤§æ•°æ®å¤„ç†æµç¨‹</h3>
        <div class="process-steps">
            <div class="process-step">
                <div class="step-icon">ğŸ“Š</div>
                <div class="step-title">æ•°æ®é‡‡é›†</div>
                <div class="step-desc">ä»è±†ç“£APIè·å–åŸå§‹æ•°æ®</div>
            </div>
            <div class="process-step">
                <div class="step-icon">ğŸ§¹</div>
                <div class="step-title">æ•°æ®æ¸…æ´—</div>
                <div class="step-desc">ä½¿ç”¨MapReduceå¤„ç†è„æ•°æ®</div>
            </div>
            <div class="process-step">
                <div class="step-icon">ğŸ”</div>
                <div class="step-title">æ•°æ®åˆ†æ</div>
                <div class="step-desc">Hiveè¿›è¡Œæ•°æ®èšåˆåˆ†æ</div>
            </div>
            <div class="process-step">
                <div class="step-icon">ğŸ“ˆ</div>
                <div class="step-title">æ•°æ®å¯è§†åŒ–</div>
                <div class="step-desc">ç»“æœå‘ˆç°ä¸äº¤äº’å±•ç¤º</div>
            </div>
        </div>
    </div>

    <div class="hadoop-cluster">
        <div class="cluster-line">hadoop fs -put douban_data /input/movies</div>
        <div class="cluster-line">hadoop jar movie_analysis.jar com.douban.MovieAnalysis /input/movies /output/ratings</div>
        <div class="cluster-line">hive -e "CREATE TABLE movie_ratings AS SELECT * FROM movie_analysis_results"</div>
        <div class="cluster-line">sqoop export --connect jdbc:mysql://db-server/douban --table top_movies --export-dir /output/ratings</div>
    </div>

    <table class="movie-table">
        <thead>
            <tr>
                <th width="50">æ’å</th>
                <th>ç”µå½±åç§°</th>
                <th width="100">è¯„åˆ†</th>
                <th width="120">è¯„ä»·äººæ•°</th>
                <th width="100">å¹´ä»½</th>
                <th>å¯¼æ¼”</th>
                <th width="120">æ•°æ®å¤„ç†èŠ‚ç‚¹</th>
            </tr>
        </thead>
        <tbody id="movie-list">
            <!-- ç”µå½±æ•°æ®å°†é€šè¿‡JavaScriptåŠ¨æ€åŠ è½½ -->
        </tbody>
    </table>

    <div class="data-source">
        <h3>Hadoopæ•°æ®å¤„ç†è¯¦æƒ…</h3>
        <p><strong>é›†ç¾¤é…ç½®ï¼š</strong> 8èŠ‚ç‚¹Hadoopé›†ç¾¤ (1 NameNode + 7 DataNodes)</p>
        <p><strong>æ•°æ®è§„æ¨¡ï¼š</strong> åŸå§‹æ•°æ®é‡ 2.7TBï¼Œå¤„ç†åæ•°æ® 450GB</p>
        <p><strong>å¤„ç†æ—¶é—´ï¼š</strong> MapReduceä½œä¸šè€—æ—¶ 23åˆ†é’Ÿ (å¹³å‡)</p>
        <p><strong>æŠ€æœ¯æ ˆï¼š</strong> Hadoop 3.3.4 + Hive 3.1.3 + Sqoop 1.4.7</p>
    </div>

    <div class="footer">
        Â© 2025 Hadoopå¤§æ•°æ®åˆ†æå¹³å° | æœ¬é¡µé¢æ•°æ®åŸºäºè±†ç“£ç”µå½±æ•°æ®é€šè¿‡Hadoopé›†ç¾¤å¤„ç†ç”Ÿæˆ
    </div>

    <script>
        // æ¨¡æ‹Ÿä»Hadoopå¤„ç†åçš„æ•°æ®å­˜å‚¨ä¸­è·å–çš„ç”µå½±æ•°æ®
        const movieData = [
            { name: "è‚–ç”³å…‹çš„æ•‘èµ", rating: 9.7, votes: 2500000, year: 1994, director: "å¼—å…°å…‹Â·å¾·æ‹‰é‚¦ç‰¹", node: "datanode3" },
            { name: "éœ¸ç‹åˆ«å§¬", rating: 9.6, votes: 1800000, year: 1993, director: "é™ˆå‡¯æ­Œ", node: "datanode5" },
            { name: "é˜¿ç”˜æ­£ä¼ ", rating: 9.5, votes: 1900000, year: 1994, director: "ç½—ä¼¯ç‰¹Â·æ³½ç±³å‰æ–¯", node: "datanode2" },
            { name: "è¿™ä¸ªæ€æ‰‹ä¸å¤ªå†·", rating: 9.4, votes: 2000000, year: 1994, director: "å•å…‹Â·è´æ¾", node: "datanode7" },
            { name: "æ³°å¦å°¼å…‹å·", rating: 9.4, votes: 1800000, year: 1997, director: "è©¹å§†æ–¯Â·å¡æ¢…éš†", node: "datanode1" },
            { name: "ç¾ä¸½äººç”Ÿ", rating: 9.5, votes: 1200000, year: 1997, director: "ç½—ä¼¯æ‰˜Â·è´å°¼å°¼", node: "datanode4" },
            { name: "åƒä¸åƒå¯»", rating: 9.4, votes: 1900000, year: 2001, director: "å®«å´éª", node: "datanode6" },
            { name: "è¾›å¾·å‹’çš„åå•", rating: 9.5, votes: 900000, year: 1993, director: "å²è’‚æ–‡Â·æ–¯çš®å°”ä¼¯æ ¼", node: "datanode3" },
            { name: "ç›—æ¢¦ç©ºé—´", rating: 9.3, votes: 1800000, year: 2010, director: "å…‹é‡Œæ–¯æ‰˜å¼—Â·è¯ºå…°", node: "datanode5" },
            { name: "å¿ çŠ¬å…«å…¬çš„æ•…äº‹", rating: 9.4, votes: 1100000, year: 2009, director: "è±å¡Â·éœå°”æ–¯é“å§†", node: "datanode2" },
            { name: "æµ·ä¸Šé’¢ç´å¸ˆ", rating: 9.3, votes: 1300000, year: 1998, director: "æœ±å¡ä½©Â·æ‰˜çº³å¤šé›·", node: "datanode7" },
            { name: "æ¥šé—¨çš„ä¸–ç•Œ", rating: 9.3, votes: 1300000, year: 1998, director: "å½¼å¾—Â·å¨å°”", node: "datanode1" },
            { name: "ä¸‰å‚»å¤§é—¹å®è±å", rating: 9.2, votes: 1600000, year: 2009, director: "æ‹‰å‰åº“é©¬å°”Â·å¸Œæ‹‰å°¼", node: "datanode4" },
            { name: "æœºå™¨äººæ€»åŠ¨å‘˜", rating: 9.3, votes: 1100000, year: 2008, director: "å®‰å¾·é²Â·æ–¯å¦é¡¿", node: "datanode6" },
            { name: "æ”¾ç‰›ç­çš„æ˜¥å¤©", rating: 9.3, votes: 1000000, year: 2004, director: "å…‹é‡Œæ–¯æ‰˜å¤«Â·å·´æ‹‰è’‚", node: "datanode3" },
            { name: "å¤§è¯è¥¿æ¸¸ä¹‹å¤§åœ£å¨¶äº²", rating: 9.2, votes: 1400000, year: 1995, director: "åˆ˜é•‡ä¼Ÿ", node: "datanode5" },
            { name: "ç–¯ç‹‚åŠ¨ç‰©åŸ", rating: 9.2, votes: 1500000, year: 2016, director: "æ‹œä¼¦Â·éœåå¾·", node: "datanode2" },
            { name: "æ— é—´é“", rating: 9.2, votes: 1200000, year: 2002, director: "åˆ˜ä¼Ÿå¼º", node: "datanode7" },
            { name: "ç†”ç‚‰", rating: 9.3, votes: 800000, year: 2011, director: "é»„ä¸œèµ«", node: "datanode1" },
            { name: "æ•™çˆ¶", rating: 9.3, votes: 800000, year: 1972, director: "å¼—æœ—è¥¿æ–¯Â·ç¦ç‰¹Â·ç§‘æ³¢æ‹‰", node: "datanode4" },
            { name: "å½“å¹¸ç¦æ¥æ•²é—¨", rating: 9.1, votes: 1300000, year: 2006, director: "åŠ å¸ƒé‡Œå°”Â·ç©†å¥‡è¯º", node: "datanode6" },
            { name: "é¾™çŒ«", rating: 9.2, votes: 1000000, year: 1988, director: "å®«å´éª", node: "datanode3" },
            { name: "æ€¦ç„¶å¿ƒåŠ¨", rating: 9.1, votes: 1400000, year: 2010, director: "ç½—ä¼¯Â·è±çº³", node: "datanode5" },
            { name: "æ§æ–¹è¯äºº", rating: 9.6, votes: 400000, year: 1957, director: "æ¯”åˆ©Â·æ€€å¾·", node: "datanode2" },
            { name: "è™è ä¾ ï¼šé»‘æš—éª‘å£«", rating: 9.2, votes: 900000, year: 2008, director: "å…‹é‡Œæ–¯æ‰˜å¼—Â·è¯ºå…°", node: "datanode7" }
        ];

        // æŒ‰è¯„åˆ†ä»é«˜åˆ°ä½æ’åº
        movieData.sort((a, b) => b.rating - a.rating);

        // æ¸²æŸ“ç”µå½±åˆ—è¡¨
        const movieList = document.getElementById('movie-list');
        movieData.forEach((movie, index) => {
            const row = document.createElement('tr');
            row.innerHTML = `
                <td class="rank">${index + 1}</td>
                <td>${movie.name}</td>
                <td class="rating">${movie.rating}</td>
                <td>${movie.votes.toLocaleString()}</td>
                <td>${movie.year}</td>
                <td>${movie.director}</td>
                <td>${movie.node}</td>
            `;
            movieList.appendChild(row);
        });

        // è®¾ç½®æ›´æ–°æ—¶é—´
        const now = new Date();
        document.getElementById('update-time').textContent = now.toLocaleString('zh-CN', {
            year: 'numeric',
            month: 'long',
            day: 'numeric',
            hour: '2-digit',
            minute: '2-digit'
        });

        // æ¨¡æ‹Ÿä»Hadoopé›†ç¾¤è·å–æ•°æ®
        console.log("æ­£åœ¨ä»Hadoopé›†ç¾¤è·å–æœ€æ–°åˆ†æç»“æœ...");
        console.log("è¿æ¥HDFS...");
        console.log("è¯»å–/output/movie_ratings/part-r-00000...");
        console.log("æ•°æ®åŠ è½½å®Œæˆ");
    </script>
</body>
</html>
