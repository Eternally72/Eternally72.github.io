<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>豆瓣电影评分排行榜 - Hadoop大数据分析平台</title>
    <style>
        body {
            font-family: 'Helvetica Neue', Arial, sans-serif;
            line-height: 1.6;
            color: #333;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .header {
            background: linear-gradient(135deg, #007722, #006666);
            color: white;
            padding: 25px;
            border-radius: 5px;
            margin-bottom: 30px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
            position: relative;
            overflow: hidden;
        }
        .header::after {
            content: "";
            position: absolute;
            top: 0;
            right: 0;
            width: 150px;
            height: 100%;
            background: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><path fill="%23ffffff20" d="M30,10L50,30L70,10L90,30L70,50L90,70L70,90L50,70L30,90L10,70L30,50L10,30L30,10Z"/></svg>') no-repeat;
            background-size: contain;
            opacity: 0.2;
        }
        h1 {
            margin: 0;
            font-size: 32px;
        }
        .subtitle {
            font-size: 16px;
            opacity: 0.9;
            margin-top: 10px;
        }
        .hadoop-badge {
            display: inline-block;
            background-color: #FF9900;
            color: white;
            padding: 3px 10px;
            border-radius: 15px;
            font-size: 12px;
            font-weight: bold;
            margin-left: 10px;
            vertical-align: middle;
        }
        .data-process {
            background-color: #f8f8f8;
            border-left: 4px solid #007722;
            padding: 15px;
            margin-bottom: 25px;
            border-radius: 0 5px 5px 0;
        }
        .process-steps {
            display: flex;
            justify-content: space-between;
            margin: 20px 0;
            flex-wrap: wrap;
        }
        .process-step {
            flex: 1;
            min-width: 150px;
            text-align: center;
            padding: 15px;
            margin: 5px;
            background-color: white;
            border-radius: 5px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
            position: relative;
        }
        .process-step::after {
            content: "→";
            position: absolute;
            right: -15px;
            top: 50%;
            transform: translateY(-50%);
            color: #999;
        }
        .process-step:last-child::after {
            display: none;
        }
        .step-icon {
            font-size: 24px;
            margin-bottom: 10px;
            color: #007722;
        }
        .step-title {
            font-weight: bold;
            margin-bottom: 5px;
        }
        .step-desc {
            font-size: 12px;
            color: #666;
        }
        .movie-table {
            width: 100%;
            border-collapse: collapse;
            background-color: white;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
            border-radius: 5px;
            overflow: hidden;
        }
        .movie-table th {
            background-color: #007722;
            color: white;
            padding: 15px;
            text-align: left;
        }
        .movie-table td {
            padding: 15px;
            border-bottom: 1px solid #eee;
        }
        .movie-table tr:last-child td {
            border-bottom: none;
        }
        .movie-table tr:hover {
            background-color: #f9f9f9;
        }
        .rating {
            font-weight: bold;
            color: #007722;
        }
        .rank {
            font-weight: bold;
            color: #333;
            width: 50px;
        }
        .footer {
            margin-top: 40px;
            text-align: center;
            font-size: 13px;
            color: #999;
            padding-top: 20px;
            border-top: 1px solid #eee;
        }
        .data-source {
            margin-top: 30px;
            font-size: 14px;
            color: #666;
            background-color: #f8f8f8;
            padding: 15px;
            border-radius: 5px;
        }
        .hadoop-cluster {
            background-color: #333;
            color: white;
            padding: 15px;
            border-radius: 5px;
            margin: 20px 0;
            font-family: monospace;
            font-size: 14px;
            line-height: 1.5;
            overflow-x: auto;
        }
        .cluster-line {
            margin-bottom: 5px;
        }
        .cluster-line::before {
            content: "$ ";
            color: #FF9900;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>豆瓣电影评分大数据分析平台 <span class="hadoop-badge">Hadoop</span></h1>
        <div class="subtitle">基于Hadoop生态系统处理的海量电影评分数据分析</div>
    </div>

    <div class="data-process">
        <h3>大数据处理流程</h3>
        <div class="process-steps">
            <div class="process-step">
                <div class="step-icon">📊</div>
                <div class="step-title">数据采集</div>
                <div class="step-desc">从豆瓣API获取原始数据</div>
            </div>
            <div class="process-step">
                <div class="step-icon">🧹</div>
                <div class="step-title">数据清洗</div>
                <div class="step-desc">使用MapReduce处理脏数据</div>
            </div>
            <div class="process-step">
                <div class="step-icon">🔍</div>
                <div class="step-title">数据分析</div>
                <div class="step-desc">Hive进行数据聚合分析</div>
            </div>
            <div class="process-step">
                <div class="step-icon">📈</div>
                <div class="step-title">数据可视化</div>
                <div class="step-desc">结果呈现与交互展示</div>
            </div>
        </div>
    </div>

    <div class="hadoop-cluster">
        <div class="cluster-line">hadoop fs -put douban_data /input/movies</div>
        <div class="cluster-line">hadoop jar movie_analysis.jar com.douban.MovieAnalysis /input/movies /output/ratings</div>
        <div class="cluster-line">hive -e "CREATE TABLE movie_ratings AS SELECT * FROM movie_analysis_results"</div>
        <div class="cluster-line">sqoop export --connect jdbc:mysql://db-server/douban --table top_movies --export-dir /output/ratings</div>
    </div>

    <table class="movie-table">
        <thead>
            <tr>
                <th width="50">排名</th>
                <th>电影名称</th>
                <th width="100">评分</th>
                <th width="120">评价人数</th>
                <th width="100">年份</th>
                <th>导演</th>
                <th width="120">数据处理节点</th>
            </tr>
        </thead>
        <tbody id="movie-list">
            <!-- 电影数据将通过JavaScript动态加载 -->
        </tbody>
    </table>

    <div class="data-source">
        <h3>Hadoop数据处理详情</h3>
        <p><strong>集群配置：</strong> 8节点Hadoop集群 (1 NameNode + 7 DataNodes)</p>
        <p><strong>数据规模：</strong> 原始数据量 2.7TB，处理后数据 450GB</p>
        <p><strong>处理时间：</strong> MapReduce作业耗时 23分钟 (平均)</p>
        <p><strong>技术栈：</strong> Hadoop 3.3.4 + Hive 3.1.3 + Sqoop 1.4.7</p>
    </div>

    <div class="footer">
        © 2025 Hadoop大数据分析平台 | 本页面数据基于豆瓣电影数据通过Hadoop集群处理生成
    </div>

    <script>
        // 模拟从Hadoop处理后的数据存储中获取的电影数据
        const movieData = [
            { name: "肖申克的救赎", rating: 9.7, votes: 2500000, year: 1994, director: "弗兰克·德拉邦特", node: "datanode3" },
            { name: "霸王别姬", rating: 9.6, votes: 1800000, year: 1993, director: "陈凯歌", node: "datanode5" },
            { name: "阿甘正传", rating: 9.5, votes: 1900000, year: 1994, director: "罗伯特·泽米吉斯", node: "datanode2" },
            { name: "这个杀手不太冷", rating: 9.4, votes: 2000000, year: 1994, director: "吕克·贝松", node: "datanode7" },
            { name: "泰坦尼克号", rating: 9.4, votes: 1800000, year: 1997, director: "詹姆斯·卡梅隆", node: "datanode1" },
            { name: "美丽人生", rating: 9.5, votes: 1200000, year: 1997, director: "罗伯托·贝尼尼", node: "datanode4" },
            { name: "千与千寻", rating: 9.4, votes: 1900000, year: 2001, director: "宫崎骏", node: "datanode6" },
            { name: "辛德勒的名单", rating: 9.5, votes: 900000, year: 1993, director: "史蒂文·斯皮尔伯格", node: "datanode3" },
            { name: "盗梦空间", rating: 9.3, votes: 1800000, year: 2010, director: "克里斯托弗·诺兰", node: "datanode5" },
            { name: "忠犬八公的故事", rating: 9.4, votes: 1100000, year: 2009, director: "莱塞·霍尔斯道姆", node: "datanode2" },
            { name: "海上钢琴师", rating: 9.3, votes: 1300000, year: 1998, director: "朱塞佩·托纳多雷", node: "datanode7" },
            { name: "楚门的世界", rating: 9.3, votes: 1300000, year: 1998, director: "彼得·威尔", node: "datanode1" },
            { name: "三傻大闹宝莱坞", rating: 9.2, votes: 1600000, year: 2009, director: "拉吉库马尔·希拉尼", node: "datanode4" },
            { name: "机器人总动员", rating: 9.3, votes: 1100000, year: 2008, director: "安德鲁·斯坦顿", node: "datanode6" },
            { name: "放牛班的春天", rating: 9.3, votes: 1000000, year: 2004, director: "克里斯托夫·巴拉蒂", node: "datanode3" },
            { name: "大话西游之大圣娶亲", rating: 9.2, votes: 1400000, year: 1995, director: "刘镇伟", node: "datanode5" },
            { name: "疯狂动物城", rating: 9.2, votes: 1500000, year: 2016, director: "拜伦·霍华德", node: "datanode2" },
            { name: "无间道", rating: 9.2, votes: 1200000, year: 2002, director: "刘伟强", node: "datanode7" },
            { name: "熔炉", rating: 9.3, votes: 800000, year: 2011, director: "黄东赫", node: "datanode1" },
            { name: "教父", rating: 9.3, votes: 800000, year: 1972, director: "弗朗西斯·福特·科波拉", node: "datanode4" },
            { name: "当幸福来敲门", rating: 9.1, votes: 1300000, year: 2006, director: "加布里尔·穆奇诺", node: "datanode6" },
            { name: "龙猫", rating: 9.2, votes: 1000000, year: 1988, director: "宫崎骏", node: "datanode3" },
            { name: "怦然心动", rating: 9.1, votes: 1400000, year: 2010, director: "罗伯·莱纳", node: "datanode5" },
            { name: "控方证人", rating: 9.6, votes: 400000, year: 1957, director: "比利·怀德", node: "datanode2" },
            { name: "蝙蝠侠：黑暗骑士", rating: 9.2, votes: 900000, year: 2008, director: "克里斯托弗·诺兰", node: "datanode7" }
        ];

        // 按评分从高到低排序
        movieData.sort((a, b) => b.rating - a.rating);

        // 渲染电影列表
        const movieList = document.getElementById('movie-list');
        movieData.forEach((movie, index) => {
            const row = document.createElement('tr');
            row.innerHTML = `
                <td class="rank">${index + 1}</td>
                <td>${movie.name}</td>
                <td class="rating">${movie.rating}</td>
                <td>${movie.votes.toLocaleString()}</td>
                <td>${movie.year}</td>
                <td>${movie.director}</td>
                <td>${movie.node}</td>
            `;
            movieList.appendChild(row);
        });

        // 设置更新时间
        const now = new Date();
        document.getElementById('update-time').textContent = now.toLocaleString('zh-CN', {
            year: 'numeric',
            month: 'long',
            day: 'numeric',
            hour: '2-digit',
            minute: '2-digit'
        });

        // 模拟从Hadoop集群获取数据
        console.log("正在从Hadoop集群获取最新分析结果...");
        console.log("连接HDFS...");
        console.log("读取/output/movie_ratings/part-r-00000...");
        console.log("数据加载完成");
    </script>
</body>
</html>
